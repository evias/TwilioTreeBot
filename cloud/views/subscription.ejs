
<%- include header -%>

    <div class="right">
        <section>
            <div class="title align-center">
                <h2>Subscribe to a Plan</h2>
                <p>Please choose one of following Plans.</p>
            </div>
            <div class="wide">
                <div class="form-box">
                    <form id="plan-subscription" name="plan-subscription" action="/subscription" method="post" novalidate="novalidate">
                        <div id="ajax-loading"><img src="/images/ajax-loading.gif" alt="Working.." /></div>

                        <% if (errorMessage) { %>
                        <div id="error">
                            <div>
                                <p>Error: <%= errorMessage %></p>
                            </div>
                        </div>
                        <% } %>

                        <div class="form-row">
                            <button id="subscribe-standard">Subscribe to Standard</button>
                        </div>
                        <div class="form-row">
                            <button id="subscribe-pro">Subscribe to PRO</button>
                        </div>

                        <div class="form-row">
                            <input type="hidden" name="stripeToken" id="stripe-token" />
                            <input type="hidden" name="stripeEmail" id="stripe-email" />
                            <input type="hidden" name="stripePlan" id="stripe-plan" />
                            <input id="subscription-submit" type="submit" name="submit" value="Save Subscription" class="btn btn-wide">
                        </div>

                    </form>
                </div>
                <div class="shadow"></div>
                <div class="meta align-center">
                    <a href="/terms-and-conditions">Terms &amp; Conditions</a>
                </div>
            </div>
        </section>
    </div>

<script src="https://checkout.stripe.com/checkout.js"></script>
<script>
var stripeHandler;
Parse.initialize("ThfEtMA3gRRKGjcf63fNTb297LWMUuhPyZtAeOhu", "tr7KcgAiaNSDMNgiEAXaw4ETjMkz04nyRIpY2fHj");

// get Stripe API Key from Parse.Config
Parse.Config.get().then(
function(config)
{
    stripeHandler = StripeCheckout.configure({
        key: config.get("stripeTestPublicKey"),
        image: '/images/logo.png',
        locale: 'auto',
        token: function(token) {
            $("#stripe-token").val(token.id);
            $("#stripe-email").val(token.email);
        }
    });
},
function(error) {});

$(document).ready(function()
{
    $("#subscribe-standard").on("click", function(e)
    {
        stripeHandler.open({
          name: 'ptFollowUp Standard',
          description: 'ptFollowUp Standard ($4.99/month)',
          panelLabel: "Subscribe",
          amount: 499,
          allowRememberMe: false
        });
        $("#stripe-plan").val("standard");
        e.preventDefault();
    });

    $("#subscribe-pro").on("click", function(e)
    {
        stripeHandler.open({
          name: 'ptFollowUp Pro',
          description: 'ptFollowUp Pro Subscription ($9.99/month)',
          panelLabel: "Subscribe",
          amount: 999,
          allowRememberMe: false
        });
        $("#stripe-plan").val("pro");
        e.preventDefault();
    });
});
</script>

<%- include footer -%>
